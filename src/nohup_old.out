2019-11-18 15:52:06.963735: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
WARNING:tensorflow:From train_cascade.py:25: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From train_cascade.py:28: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From train_cascade.py:198: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-11-18 15:52:18.843427: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-11-18 15:52:18.850585: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2300000000 Hz
2019-11-18 15:52:18.851509: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555daee60660 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-11-18 15:52:18.851537: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-11-18 15:52:18.854412: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-11-18 15:52:20.400505: E tensorflow/stream_executor/cuda/cuda_driver.cc:318] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2019-11-18 15:52:20.400601: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: fiveeightfive-tf
2019-11-18 15:52:20.400613: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: fiveeightfive-tf
2019-11-18 15:52:20.400782: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 410.104.0
2019-11-18 15:52:20.400819: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 410.104.0
2019-11-18 15:52:20.400828: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 410.104.0
WARNING:tensorflow:From /home/chirag1goel/CASCADE/src/text_cnn.py:15: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/chirag1goel/CASCADE/src/text_cnn.py:40: The name tf.truncated_normal is deprecated. Please use tf.random.truncated_normal instead.

WARNING:tensorflow:From /home/chirag1goel/CASCADE/src/text_cnn.py:51: The name tf.nn.max_pool is deprecated. Please use tf.nn.max_pool2d instead.

WARNING:tensorflow:From /home/chirag1goel/CASCADE/src/text_cnn.py:66: The name tf.random_normal is deprecated. Please use tf.random.normal instead.

WARNING:tensorflow:From /home/chirag1goel/CASCADE/src/text_cnn.py:68: The name tf.nn.xw_plus_b is deprecated. Please use tf.compat.v1.nn.xw_plus_b instead.

WARNING:tensorflow:From /home/chirag1goel/CASCADE/src/text_cnn.py:82: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /home/chirag1goel/CASCADE/src/text_cnn.py:86: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/chirag1goel/CASCADE/src/text_cnn.py:99: softmax_cross_entropy_with_logits (from tensorflow.python.ops.nn_ops) is deprecated and will be removed in a future version.
Instructions for updating:

Future major versions of TensorFlow will allow gradients to flow
into the labels input on backprop by default.

See `tf.nn.softmax_cross_entropy_with_logits_v2`.

WARNING:tensorflow:From train_cascade.py:216: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From train_cascade.py:219: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From train_cascade.py:219: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.

WARNING:tensorflow:From train_cascade.py:220: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From train_cascade.py:221: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From train_cascade.py:275: The name tf.train.global_step is deprecated. Please use tf.compat.v1.train.global_step instead.

loading data...
data loaded!
loading wgcca embeddings...
wgcca embeddings loaded
topic emb size:  100
Train/Dev split: 139232/15470
Tensor("output/scores:0", shape=(?, 2), dtype=float32)
0
1
2
100
Train loss 27.9155, Train acc 0.642559
Valid loss 4.73773, Valid acc 0.731739
Valid - Confusion Matrix: 
[[5659. 2045.]
 [2105. 5661.]]
Test loss 4.5667, Test acc 0.733214
Test - Confusion Matrix: 
[[23801.  8532.]
 [ 8720. 23613.]]
3
4
5
200
Train loss 3.05137, Train acc 0.735483
Valid loss 1.82015, Valid acc 0.732127
Valid - Confusion Matrix: 
[[5130. 2574.]
 [1570. 6196.]]
Test loss 1.8076, Test acc 0.727306
Test - Confusion Matrix: 
[[21486. 10847.]
 [ 6787. 25546.]]
6
7
8
300
Train loss 1.34955, Train acc 0.756365
Valid loss 1.40691, Valid acc 0.738979
Valid - Confusion Matrix: 
[[5330. 2374.]
 [1664. 6102.]]
Test loss 1.40563, Test acc 0.733616
Test - Confusion Matrix: 
[[22248. 10085.]
 [ 7141. 25192.]]
9
10
11
400
Train loss 1.06254, Train acc 0.793067
Valid loss 1.33594, Valid acc 0.722948
Valid - Confusion Matrix: 
[[5891. 1813.]
 [2473. 5293.]]
Test loss 1.33445, Test acc 0.721925
Test - Confusion Matrix: 
[[24754.  7579.]
 [10403. 21930.]]
12
13
14
500
Train loss 0.960665, Train acc 0.813087
Valid loss 1.31965, Valid acc 0.744926
Valid - Confusion Matrix: 
[[4914. 2790.]
 [1156. 6610.]]
Test loss 1.31912, Test acc 0.742724
Test - Confusion Matrix: 
[[20482. 11851.]
 [ 4786. 27547.]]
15
16
17
600
Train loss 0.877127, Train acc 0.83611
Valid loss 1.27558, Valid acc 0.716613
Valid - Confusion Matrix: 
[[6121. 1583.]
 [2801. 4965.]]
Test loss 1.27401, Test acc 0.711641
Test - Confusion Matrix: 
[[25593.  6740.]
 [11907. 20426.]]
18
19
20
700
Train loss 0.823882, Train acc 0.848013
Valid loss 1.23481, Valid acc 0.738009
Valid - Confusion Matrix: 
[[5815. 1889.]
 [2164. 5602.]]
Test loss 1.23202, Test acc 0.733477
Test - Confusion Matrix: 
[[24365.  7968.]
 [ 9267. 23066.]]
21
22
23
800
Train loss 0.776807, Train acc 0.85741
Valid loss 1.22793, Valid acc 0.72437
Valid - Confusion Matrix: 
[[6098. 1606.]
 [2658. 5108.]]
Test loss 1.2244, Test acc 0.719389
Test - Confusion Matrix: 
[[25551.  6782.]
 [11364. 20969.]]
24
25
26
900
Train loss 0.739052, Train acc 0.864039
Valid loss 1.21626, Valid acc 0.752941
Valid - Confusion Matrix: 
[[5142. 2562.]
 [1260. 6506.]]
Test loss 1.2103, Test acc 0.751059
Test - Confusion Matrix: 
[[21501. 10832.]
 [ 5266. 27067.]]
27
28
29
1000
Train loss 0.694787, Train acc 0.874673
Valid loss 1.18176, Valid acc 0.752877
Valid - Confusion Matrix: 
[[5422. 2282.]
 [1541. 6225.]]
Test loss 1.17476, Test acc 0.748322
Test - Confusion Matrix: 
[[22665.  9668.]
 [ 6607. 25726.]]
30
31
32
1100
Train loss 0.651464, Train acc 0.886369
Valid loss 1.16334, Valid acc 0.751325
Valid - Confusion Matrix: 
[[5523. 2181.]
 [1666. 6100.]]
Test loss 1.15706, Test acc 0.747796
Test - Confusion Matrix: 
[[23138.  9195.]
 [ 7114. 25219.]]
33
34
35
1200
Train loss 0.616829, Train acc 0.893004
Valid loss 1.15076, Valid acc 0.753652
Valid - Confusion Matrix: 
[[5499. 2205.]
 [1606. 6160.]]
Test loss 1.1446, Test acc 0.749204
Test - Confusion Matrix: 
[[23013.  9320.]
 [ 6898. 25435.]]
36
37
38
1300
Train loss 0.580527, Train acc 0.900917
Valid loss 1.14427, Valid acc 0.753588
Valid - Confusion Matrix: 
[[5531. 2173.]
 [1639. 6127.]]
Test loss 1.13591, Test acc 0.750951
Test - Confusion Matrix: 
[[23180.  9153.]
 [ 6952. 25381.]]
39
40
41
1400
Train loss 0.546391, Train acc 0.908572
Valid loss 1.12934, Valid acc 0.754169
Valid - Confusion Matrix: 
[[5653. 2051.]
 [1752. 6014.]]
Test loss 1.12177, Test acc 0.748446
Test - Confusion Matrix: 
[[23572.  8761.]
 [ 7506. 24827.]]
42
43
44
1500
Train loss 0.515369, Train acc 0.914794
Valid loss 1.1351, Valid acc 0.754234
Valid - Confusion Matrix: 
[[5420. 2284.]
 [1518. 6248.]]
Test loss 1.12611, Test acc 0.751585
Test - Confusion Matrix: 
[[22690.  9643.]
 [ 6421. 25912.]]
45
46
47
1600
Train loss 0.484971, Train acc 0.920436
Valid loss 1.13401, Valid acc 0.755979
Valid - Confusion Matrix: 
[[5480. 2224.]
 [1551. 6215.]]
Test loss 1.12597, Test acc 0.751678
Test - Confusion Matrix: 
[[22854.  9479.]
 [ 6579. 25754.]]
48
49
1700
Train loss 0.455138, Train acc 0.926412
Valid loss 1.11735, Valid acc 0.755462
Valid - Confusion Matrix: 
[[5601. 2103.]
 [1680. 6086.]]
Test loss 1.10876, Test acc 0.752436
Test - Confusion Matrix: 
[[23385.  8948.]
 [ 7061. 25272.]]
50
51
52
1800
Train loss 0.423677, Train acc 0.934108
Valid loss 1.12628, Valid acc 0.754945
Valid - Confusion Matrix: 
[[5581. 2123.]
 [1668. 6098.]]
Test loss 1.11675, Test acc 0.751477
Test - Confusion Matrix: 
[[23260.  9073.]
 [ 6998. 25335.]]
53
54
55
1900
Train loss 0.394865, Train acc 0.940098
Valid loss 1.1152, Valid acc 0.756173
Valid - Confusion Matrix: 
[[5649. 2055.]
 [1717. 6049.]]
Test loss 1.10619, Test acc 0.754044
Test - Confusion Matrix: 
[[23601.  8732.]
 [ 7173. 25160.]]
56
57
58
2000
Train loss 0.371108, Train acc 0.944262
Valid loss 1.13708, Valid acc 0.755268
Valid - Confusion Matrix: 
[[5708. 1996.]
 [1790. 5976.]]
Test loss 1.12529, Test acc 0.754229
Test - Confusion Matrix: 
[[23952.  8381.]
 [ 7512. 24821.]]
59
60
61
2100
Train loss 0.343691, Train acc 0.950125
Valid loss 1.1353, Valid acc 0.755204
Valid - Confusion Matrix: 
[[5675. 2029.]
 [1758. 6008.]]
Test loss 1.12367, Test acc 0.753905
Test - Confusion Matrix: 
[[23732.  8601.]
 [ 7313. 25020.]]
62
63
64
2200
Train loss 0.319917, Train acc 0.954987
Valid loss 1.16273, Valid acc 0.760116
Valid - Confusion Matrix: 
[[5517. 2187.]
 [1524. 6242.]]
Test loss 1.14815, Test acc 0.758606
Test - Confusion Matrix: 
[[23079.  9254.]
 [ 6356. 25977.]]
65
66
67
2300
Train loss 0.297591, Train acc 0.959109
Valid loss 1.16026, Valid acc 0.757337
Valid - Confusion Matrix: 
[[5760. 1944.]
 [1810. 5956.]]
Test loss 1.14647, Test acc 0.754601
Test - Confusion Matrix: 
[[24036.  8297.]
 [ 7572. 24761.]]
68
69
70
2400
Train loss 0.275602, Train acc 0.962933
Valid loss 1.16915, Valid acc 0.758824
Valid - Confusion Matrix: 
[[5696. 2008.]
 [1723. 6043.]]
Test loss 1.15365, Test acc 0.75593
Test - Confusion Matrix: 
[[23816.  8517.]
 [ 7266. 25067.]]
71
72
73
2500
Train loss 0.253837, Train acc 0.967397
Valid loss 1.19108, Valid acc 0.759922
Valid - Confusion Matrix: 
[[5629. 2075.]
 [1639. 6127.]]
Test loss 1.17541, Test acc 0.758266
Test - Confusion Matrix: 
[[23502.  8831.]
 [ 6801. 25532.]]
74
75
76
2600
Train loss 0.235681, Train acc 0.970358
Valid loss 1.18916, Valid acc 0.757789
Valid - Confusion Matrix: 
[[5752. 1952.]
 [1795. 5971.]]
Test loss 1.17495, Test acc 0.756441
Test - Confusion Matrix: 
[[24139.  8194.]
 [ 7556. 24777.]]
77
78
79
2700
Train loss 0.217818, Train acc 0.97316
Valid loss 1.21873, Valid acc 0.759987
Valid - Confusion Matrix: 
[[5679. 2025.]
 [1688. 6078.]]
Test loss 1.20509, Test acc 0.758296
Test - Confusion Matrix: 
[[23728.  8605.]
 [ 7025. 25308.]]
80
81
82
2800
Train loss 0.200584, Train acc 0.976154
Valid loss 1.22899, Valid acc 0.758177
Valid - Confusion Matrix: 
[[5824. 1880.]
 [1861. 5905.]]
Test loss 1.21508, Test acc 0.756101
Test - Confusion Matrix: 
[[24343.  7990.]
 [ 7782. 24551.]]
83
84
85
2900
Train loss 0.184402, Train acc 0.9792
Valid loss 1.25913, Valid acc 0.761021
Valid - Confusion Matrix: 
[[5566. 2138.]
 [1559. 6207.]]
Test loss 1.2475, Test acc 0.759302
Test - Confusion Matrix: 
[[23307.  9026.]
 [ 6539. 25794.]]
86
87
88
3000
Train loss 0.16971, Train acc 0.980974
Valid loss 1.30261, Valid acc 0.763025
Valid - Confusion Matrix: 
[[5482. 2222.]
 [1444. 6322.]]
Test loss 1.28543, Test acc 0.761126
Test - Confusion Matrix: 
[[22940.  9393.]
 [ 6054. 26279.]]
89
90
91
3100
Train loss 0.155487, Train acc 0.983383
Valid loss 1.30318, Valid acc 0.760504
Valid - Confusion Matrix: 
[[5808. 1896.]
 [1809. 5957.]]
Test loss 1.28248, Test acc 0.758266
Test - Confusion Matrix: 
[[24303.  8030.]
 [ 7602. 24731.]]
92
93
94
3200
Train loss 0.142957, Train acc 0.985062
Valid loss 1.3238, Valid acc 0.760375
Valid - Confusion Matrix: 
[[5766. 1938.]
 [1769. 5997.]]
Test loss 1.30296, Test acc 0.757972
Test - Confusion Matrix: 
[[24144.  8189.]
 [ 7462. 24871.]]
95
96
97
3300
Train loss 0.130979, Train acc 0.986906
Valid loss 1.355, Valid acc 0.762896
Valid - Confusion Matrix: 
[[5651. 2053.]
 [1615. 6151.]]
Test loss 1.33394, Test acc 0.760168
Test - Confusion Matrix: 
[[23589.  8744.]
 [ 6765. 25568.]]
98
99
3400
Train loss 0.120565, Train acc 0.988076
Valid loss 1.38117, Valid acc 0.76393
Valid - Confusion Matrix: 
[[5606. 2098.]
 [1554. 6212.]]
Test loss 1.36425, Test acc 0.761992
Test - Confusion Matrix: 
[[23463.  8870.]
 [ 6521. 25812.]]
